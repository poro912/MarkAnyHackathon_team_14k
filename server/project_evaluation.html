<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í”„ë¡œì íŠ¸ í‰ê°€</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 40px;
            background: #f8f9fa;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .header h1 {
            color: #333;
            margin-bottom: 10px;
        }

        .header p {
            color: #666;
            font-size: 16px;
        }

        .coming-soon {
            background: white;
            padding: 60px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            text-align: center;
        }

        .coming-soon-icon {
            font-size: 80px;
            margin-bottom: 20px;
        }

        .coming-soon h2 {
            color: #333;
            margin-bottom: 15px;
            font-size: 28px;
        }

        .coming-soon p {
            color: #666;
            font-size: 16px;
            line-height: 1.6;
            margin-bottom: 30px;
        }

        .features-preview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 40px;
        }

        .feature-card {
            background: white;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .feature-card h3 {
            color: #333;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }

        .feature-card h3 span {
            margin-right: 10px;
            font-size: 20px;
        }

        .feature-card p {
            color: #666;
            line-height: 1.5;
        }

        .progress-bar {
            background: #e9ecef;
            border-radius: 10px;
            height: 8px;
            margin-top: 15px;
            overflow: hidden;
        }

        .progress-fill {
            background: linear-gradient(90deg, #667eea, #764ba2);
            height: 100%;
            border-radius: 10px;
            transition: width 0.3s ease;
        }

        .status {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“Š í”„ë¡œì íŠ¸ í‰ê°€</h1>
            <p>AI ê¸°ë°˜ ì½”ë“œ í’ˆì§ˆ ë¶„ì„ ë° í”„ë¡œì íŠ¸ í‰ê°€ ë„êµ¬</p>
        </div>

        <div class="coming-soon">
            <div class="coming-soon-icon">ğŸš§</div>
            <h2>ê°œë°œ ì¤‘ì…ë‹ˆë‹¤</h2>
            <p>
                í”„ë¡œì íŠ¸ í‰ê°€ ê¸°ëŠ¥ì€ í˜„ì¬ ê°œë°œ ì¤‘ì…ë‹ˆë‹¤.<br>
                ê³§ ê°•ë ¥í•œ AI ê¸°ë°˜ ì½”ë“œ ë¶„ì„ ë„êµ¬ë¥¼ ë§Œë‚˜ë³´ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
            </p>
        </div>

        <!-- GitHub ë¶„ì„ ì„¹ì…˜ -->
        <div class="github-analyzer" style="background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); margin-bottom: 30px;">
            <h2 style="color: #333; margin-bottom: 20px; display: flex; align-items: center;">
                <span style="margin-right: 10px; font-size: 24px;">ğŸ”</span>
                GitHub ë ˆí¬ì§€í„°ë¦¬ ë¶„ì„
            </h2>
            
            <div class="add-repo" style="margin-bottom: 20px;">
                <input type="text" id="repoUrl" placeholder="GitHub ë ˆí¬ì§€í„°ë¦¬ URL ì…ë ¥ (ì˜ˆ: https://github.com/user/repo)" 
                       style="width: 400px; padding: 12px; border: 1px solid #ddd; border-radius: 6px; margin-right: 10px; font-size: 14px;" />
                <button onclick="addRepository()" 
                        style="padding: 12px 20px; background: #667eea; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 14px;">
                    ë ˆí¬ì§€í„°ë¦¬ ì¶”ê°€
                </button>
            </div>

            <div class="tabs" id="tabs" style="display: flex; margin-bottom: 20px; border-bottom: 1px solid #ddd;"></div>
            
            <div class="content" id="content" style="min-height: 400px;">
                <div class="loading" style="text-align: center; padding: 50px; color: #666;">
                    ë ˆí¬ì§€í„°ë¦¬ë¥¼ ì¶”ê°€í•˜ì—¬ ë¶„ì„ì„ ì‹œì‘í•˜ì„¸ìš”
                </div>
            </div>
        </div>

        <div class="features-preview">
            <div class="feature-card">
                <h3><span>ğŸ”</span>ì½”ë“œ í’ˆì§ˆ ë¶„ì„</h3>
                <p>ì½”ë“œì˜ ë³µì¡ë„, ê°€ë…ì„±, ìœ ì§€ë³´ìˆ˜ì„±ì„ ì¢…í•©ì ìœ¼ë¡œ ë¶„ì„í•˜ì—¬ í’ˆì§ˆ ì ìˆ˜ë¥¼ ì œê³µí•©ë‹ˆë‹¤.</p>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 75%;"></div>
                </div>
                <div class="status">ê°œë°œ ì§„í–‰ë¥ : 75%</div>
            </div>

            <div class="feature-card">
                <h3><span>ğŸ›¡ï¸</span>ë³´ì•ˆ ì·¨ì•½ì  ê²€ì‚¬</h3>
                <p>ì ì¬ì ì¸ ë³´ì•ˆ ìœ„í—˜ ìš”ì†Œë¥¼ ì‹ë³„í•˜ê³  ê°œì„  ë°©ì•ˆì„ ì œì‹œí•©ë‹ˆë‹¤.</p>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 60%;"></div>
                </div>
                <div class="status">ê°œë°œ ì§„í–‰ë¥ : 60%</div>
            </div>

            <div class="feature-card">
                <h3><span>âš¡</span>ì„±ëŠ¥ ìµœì í™” ì œì•ˆ</h3>
                <p>ì½”ë“œ ì„±ëŠ¥ì„ ë¶„ì„í•˜ê³  ìµœì í™” ë°©ì•ˆì„ AIê°€ ìë™ìœ¼ë¡œ ì œì•ˆí•©ë‹ˆë‹¤.</p>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 45%;"></div>
                </div>
                <div class="status">ê°œë°œ ì§„í–‰ë¥ : 45%</div>
            </div>

            <div class="feature-card">
                <h3><span>ğŸ“ˆ</span>í”„ë¡œì íŠ¸ ë©”íŠ¸ë¦­</h3>
                <p>ë¼ì¸ ìˆ˜, í•¨ìˆ˜ ë³µì¡ë„, ì˜ì¡´ì„± ë“± í”„ë¡œì íŠ¸ì˜ ë‹¤ì–‘í•œ ì§€í‘œë¥¼ ì‹œê°í™”í•©ë‹ˆë‹¤.</p>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 30%;"></div>
                </div>
                <div class="status">ê°œë°œ ì§„í–‰ë¥ : 30%</div>
            </div>

            <div class="feature-card">
                <h3><span>ğŸ¯</span>ê°œì„  ë¡œë“œë§µ</h3>
                <p>ë¶„ì„ ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ í”„ë¡œì íŠ¸ ê°œì„ ì„ ìœ„í•œ ë‹¨ê³„ë³„ ë¡œë“œë§µì„ ì œê³µí•©ë‹ˆë‹¤.</p>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 20%;"></div>
                </div>
                <div class="status">ê°œë°œ ì§„í–‰ë¥ : 20%</div>
            </div>

            <div class="feature-card">
                <h3><span>ğŸ“‹</span>ìƒì„¸ ë¦¬í¬íŠ¸</h3>
                <p>ë¶„ì„ ê²°ê³¼ë¥¼ PDF ë˜ëŠ” HTML í˜•íƒœì˜ ìƒì„¸ ë¦¬í¬íŠ¸ë¡œ ìƒì„±í•©ë‹ˆë‹¤.</p>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 10%;"></div>
                </div>
                <div class="status">ê°œë°œ ì§„í–‰ë¥ : 10%</div>
            </div>
        </div>
    </div>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script>
        let repositories = [];
        let activeRepo = null;

        function addRepository() {
            const url = document.getElementById('repoUrl').value.trim();
            if (!url) return;

            const match = url.match(/github\.com\/([^\/]+)\/([^\/]+)/);
            if (!match) {
                alert('ì˜¬ë°”ë¥¸ GitHub URLì„ ì…ë ¥í•˜ì„¸ìš”');
                return;
            }

            const owner = match[1];
            const repo = match[2].replace('.git', '');
            const repoId = `${owner}/${repo}`;

            if (repositories.find(r => r.id === repoId)) {
                alert('ì´ë¯¸ ì¶”ê°€ëœ ë ˆí¬ì§€í„°ë¦¬ì…ë‹ˆë‹¤');
                return;
            }

            const repository = {
                id: repoId,
                owner: owner,
                name: repo,
                url: url,
                commits: [],
                files: []
            };

            repositories.push(repository);
            document.getElementById('repoUrl').value = '';
            
            renderTabs();
            loadRepository(repository);
        }

        function renderTabs() {
            const tabsContainer = document.getElementById('tabs');
            tabsContainer.innerHTML = '';

            repositories.forEach(repo => {
                const tab = document.createElement('div');
                tab.style.cssText = `
                    padding: 10px 15px;
                    background: ${activeRepo?.id === repo.id ? '#667eea' : '#f8f9fa'};
                    color: ${activeRepo?.id === repo.id ? 'white' : '#333'};
                    border-radius: 6px 6px 0 0;
                    cursor: pointer;
                    margin-right: 5px;
                    display: inline-flex;
                    align-items: center;
                `;
                tab.innerHTML = `
                    <span onclick="selectRepository('${repo.id}')">${repo.name}</span>
                    <span onclick="removeRepository('${repo.id}')" style="margin-left: 10px; color: #999; font-weight: bold; cursor: pointer;">&times;</span>
                `;
                tabsContainer.appendChild(tab);
            });
        }

        function selectRepository(repoId) {
            activeRepo = repositories.find(r => r.id === repoId);
            renderTabs();
            renderRepository();
        }

        function removeRepository(repoId) {
            repositories = repositories.filter(r => r.id !== repoId);
            if (activeRepo?.id === repoId) {
                activeRepo = repositories[0] || null;
            }
            renderTabs();
            if (activeRepo) {
                renderRepository();
            } else {
                document.getElementById('content').innerHTML = '<div style="text-align: center; padding: 50px; color: #666;">ë ˆí¬ì§€í„°ë¦¬ë¥¼ ì¶”ê°€í•˜ì—¬ ë¶„ì„ì„ ì‹œì‘í•˜ì„¸ìš”</div>';
            }
        }

        async function loadRepository(repository) {
            activeRepo = repository;
            renderTabs();
            
            document.getElementById('content').innerHTML = '<div style="text-align: center; padding: 50px; color: #666;">ë ˆí¬ì§€í„°ë¦¬ ì •ë³´ë¥¼ ë¡œë”© ì¤‘...</div>';

            try {
                const repoResponse = await fetch(`/api/github/repos/${repository.id}`);
                const repoData = await repoResponse.json();

                const commitsResponse = await fetch(`/api/github/repos/${repository.id}/commits?per_page=50`);
                const commitsData = await commitsResponse.json();

                repository.info = repoData;
                repository.commits = commitsData;

                renderRepository();
                renderNetworkGraph();
            } catch (error) {
                document.getElementById('content').innerHTML = `<div style="color: #ff4444; background: #fff5f5; padding: 15px; border-radius: 6px;">ë ˆí¬ì§€í„°ë¦¬ ë¡œë”© ì‹¤íŒ¨: ${error.message}</div>`;
            }
        }

        function renderRepository() {
            if (!activeRepo) return;

            const content = document.getElementById('content');
            content.innerHTML = `
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 6px;">
                        <h3 style="color: #333; margin-bottom: 10px;">ğŸ“Š ë ˆí¬ì§€í„°ë¦¬ ì •ë³´</h3>
                        <p><strong>ì´ë¦„:</strong> ${activeRepo.info?.name || activeRepo.name}</p>
                        <p><strong>ì„¤ëª…:</strong> ${activeRepo.info?.description || 'ì„¤ëª… ì—†ìŒ'}</p>
                        <p><strong>ì–¸ì–´:</strong> ${activeRepo.info?.language || 'ì•Œ ìˆ˜ ì—†ìŒ'}</p>
                        <p><strong>ìŠ¤íƒ€:</strong> ${activeRepo.info?.stargazers_count || 0}</p>
                    </div>
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 6px;">
                        <h3 style="color: #333; margin-bottom: 10px;">ğŸ“ˆ í†µê³„</h3>
                        <p><strong>ì»¤ë°‹ ìˆ˜:</strong> ${activeRepo.commits?.length || 0}</p>
                        <p><strong>ë¸Œëœì¹˜:</strong> ${activeRepo.info?.default_branch || 'main'}</p>
                        <p><strong>ìƒì„±ì¼:</strong> ${activeRepo.info?.created_at ? new Date(activeRepo.info.created_at).toLocaleDateString() : 'ì•Œ ìˆ˜ ì—†ìŒ'}</p>
                        <p><strong>ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸:</strong> ${activeRepo.info?.updated_at ? new Date(activeRepo.info.updated_at).toLocaleDateString() : 'ì•Œ ìˆ˜ ì—†ìŒ'}</p>
                    </div>
                </div>
                
                <h3 style="color: #333; margin-bottom: 15px;">ğŸŒ ì»¤ë°‹ ë„¤íŠ¸ì›Œí¬ ê·¸ë˜í”„</h3>
                <div id="networkGraph" style="width: 100%; height: 400px; border: 1px solid #ddd; border-radius: 6px; margin-bottom: 20px;"></div>
                
                <div id="commitDetails" style="background: #f8f9fa; padding: 15px; border-radius: 6px; display: none;">
                    <h3 style="color: #333; margin-bottom: 10px;">ğŸ“ ì»¤ë°‹ ìƒì„¸ ì •ë³´</h3>
                    <div id="commitInfo"></div>
                    <div id="codeDiff" style="margin-top: 15px;"></div>
                </div>
            `;

            renderNetworkGraph();
        }

        function renderNetworkGraph() {
            if (!activeRepo?.commits) return;

            const container = document.getElementById('networkGraph');
            if (!container) return;

            container.innerHTML = '';

            const width = container.clientWidth;
            const height = 400;

            const svg = d3.select('#networkGraph')
                .append('svg')
                .attr('width', width)
                .attr('height', height);

            const commits = activeRepo.commits.slice(0, 20);

            const xScale = d3.scaleTime()
                .domain(d3.extent(commits, d => new Date(d.commit.author.date)))
                .range([50, width - 50]);

            svg.selectAll('.commit-node')
                .data(commits)
                .enter()
                .append('circle')
                .attr('class', 'commit-node')
                .attr('cx', d => xScale(new Date(d.commit.author.date)))
                .attr('cy', height / 2)
                .attr('r', 8)
                .attr('fill', '#667eea')
                .attr('stroke', '#fff')
                .attr('stroke-width', 2)
                .style('cursor', 'pointer')
                .on('click', (event, d) => showCommitDetails(d))
                .on('mouseover', function(event, d) {
                    d3.select(this).attr('r', 12);
                })
                .on('mouseout', function() {
                    d3.select(this).attr('r', 8);
                });

            for (let i = 0; i < commits.length - 1; i++) {
                svg.append('line')
                    .attr('x1', xScale(new Date(commits[i].commit.author.date)))
                    .attr('y1', height / 2)
                    .attr('x2', xScale(new Date(commits[i + 1].commit.author.date)))
                    .attr('y2', height / 2)
                    .attr('stroke', '#ddd')
                    .attr('stroke-width', 2);
            }

            const xAxis = d3.axisBottom(xScale).tickFormat(d3.timeFormat('%m/%d'));
            svg.append('g')
                .attr('transform', `translate(0, ${height - 30})`)
                .call(xAxis);
        }

        async function showCommitDetails(commit) {
            const detailsContainer = document.getElementById('commitDetails');
            const commitInfo = document.getElementById('commitInfo');
            const codeDiff = document.getElementById('codeDiff');

            detailsContainer.style.display = 'block';

            commitInfo.innerHTML = `
                <p><strong>ì»¤ë°‹:</strong> ${commit.sha.substring(0, 8)}</p>
                <p><strong>ë©”ì‹œì§€:</strong> ${commit.commit.message}</p>
                <p><strong>ì‘ì„±ì:</strong> ${commit.commit.author.name}</p>
                <p><strong>ë‚ ì§œ:</strong> ${new Date(commit.commit.author.date).toLocaleString()}</p>
            `;

            codeDiff.innerHTML = '<div style="text-align: center; padding: 20px; color: #666;">ì½”ë“œ ë³€ê²½ì‚¬í•­ì„ ë¡œë”© ì¤‘...</div>';

            try {
                const diffResponse = await fetch(`/api/github/repos/${activeRepo.id}/commits/${commit.sha}`);
                const diffData = await diffResponse.json();

                let diffHtml = '';
                if (diffData.files && diffData.files.length > 0) {
                    diffData.files.slice(0, 3).forEach(file => {
                        diffHtml += `
                            <div style="background: white; border: 1px solid #ddd; border-radius: 4px; margin-bottom: 10px;">
                                <h4 style="background: #f1f3f4; padding: 10px; margin: 0; border-bottom: 1px solid #ddd;">ğŸ“„ ${file.filename}</h4>
                                <pre style="padding: 15px; margin: 0; overflow-x: auto; font-size: 12px; line-height: 1.4;">${file.patch || 'ë³€ê²½ì‚¬í•­ ì—†ìŒ'}</pre>
                            </div>
                        `;
                    });
                } else {
                    diffHtml = '<div style="background: white; border: 1px solid #ddd; border-radius: 4px; padding: 15px;">ë³€ê²½ì‚¬í•­ ì—†ìŒ</div>';
                }

                codeDiff.innerHTML = diffHtml;
            } catch (error) {
                codeDiff.innerHTML = `<div style="color: #ff4444; background: #fff5f5; padding: 15px; border-radius: 6px;">ì½”ë“œ ë³€ê²½ì‚¬í•­ ë¡œë”© ì‹¤íŒ¨: ${error.message}</div>`;
            }
        }
    </script>
</body>
</html>
